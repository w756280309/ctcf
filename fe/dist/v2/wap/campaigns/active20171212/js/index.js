function closeDoor(){$(".cue-close").click(function(){$(".box-top").css("display","none"),refreshPage()})}function initScroll(){var e;intervalTime=setInterval(function(){var t=$("#wrapper ul").height();t>0&&(clearInterval(intervalTime),e=new iScroll("wrapper",{vScrollbar:!1}))},1)}function toastCenter(e,t){var n=$('<div class="error-info" style="display: block; position: fixed;font-size: .4rem;"><div>'+e+"</div></div>");$("body").append(n),n.find("div").width(n.width()),setTimeout(function(){n.fadeOut(),setTimeout(function(){n.remove()},200),t&&t()},2e3)}function imgChange(){var e=document.querySelector(".money-amounts");$(".ice-thing").attr("mark","hide"),$(".ice-thing").click(function(){"show"==$(".ice-thing").attr("mark")?(this.src=feBaseUrl+"wap/campaigns/active20171212/images/bg-ice2.png",$(".ice-thing").attr("mark","hide"),$(e).html("*****")):"hide"==$(".ice-thing").attr("mark")&&(this.src=feBaseUrl+"wap/campaigns/active20171212/images/bg-ice1.png",$(".ice-thing").attr("mark","show"),$(e).html(accountBalance))})}function getTicket(){{var e=document.querySelector(".contain"),t=document.querySelector(".get-tecket"),n=document.querySelector(".box-top");document.querySelector(".box-top-mid"),document.querySelector(".box-contain")}t.addEventListener("touchstart",function(t){var t=t||window.event;t.preventDefault();var i=$("input[name=promoStatus]").val();return 0==i?($.ajax({type:"get",dataType:"json",url:"/promotion/p171212/pull",data:"",success:function(e){0==e.num?($(".box-top-mid").css("height","7.2rem"),$(".box-contain").find(".p-hint").html("您暂时还未获得加息券哦，余额达到5万即可领取，快去充值吧!").css("margin","0.7rem auto 0.3rem").css("fontSize","0.53rem"),$(".box-contain>.a-div").remove(),$(".box-contain").find(".mid-wire").remove(),$(".box-contain").find(".p-mid").remove(),$(".box-contain").find(".contain-quan").html('<a class="go-pay" href="/user/userbank/recharge">去充值</a>')):e.num>0&&e.num<5?$(".box-contain").find(".p-hint").find("span").html(e.num):5==e.num&&($(".box-contain").find(".p-hint").html("您已获得全部加息券，仅限活动 期间使用哦！快去开启加息吧！"),$(".box-contain>.a-div").css("width","3.30666667rem"),$(".box-contain>.a-div").html('<a href="/deal/deal/index?t=1">使用加息券</a>'));var t=document.getElementById("addTicket").innerHTML,n=Handlebars.compile(t),i=e.award,o=n(i);$(".contain-quan").find("ul").html(o)},complete:function(){n.style.display="block",n.addEventListener("touchmove",function(e){var e=e||window.event;e.preventDefault()},!1),e.addEventListener("touchmove",function(e){var e=e||window.event;e.preventDefault()},!1)}}),!1):void(1==i?toastCenter("活动未开始"):2==i&&toastCenter("活动已结束"))})}function refreshPage(){var e=isWeiXin();if(e){var t=getParamsString();t=""===t?"?t="+Math.random():"&t="+Math.random(),location.href=location.href+t}else location.reload()}function isWeiXin(){var e=window.navigator.userAgent.toLowerCase();return"micromessenger"==e.match(/MicroMessenger/i)?!0:!1}function getParamsString(){var e=location.search,t="";return-1!=e.indexOf("?")&&(t=e.substr(1)),t}window.onload=function(){FastClick.attach(document.body);var e=$("input[name=promoStatus]").val();1==e?toastCenter("活动未开始"):2==e&&toastCenter("活动已结束"),imgChange(),getTicket(),initScroll(),closeDoor()};