function closeShare(){$("body").on("click",function(e){($(e.target).hasClass("share-box")||$(e.target).hasClass("share-box-img"))&&($(".share-box").hide().remove(),$(".mark-box").hide().remove())})}function popShare(){var e='<div class="mark-box" style="display: none;position: fixed;left: 0;bottom:0;width: 100%;height: 100%;background: #000;opacity: 0.6;z-index: 11;" ></div><div class="share-box" style="display: none;position: fixed;left: 0;bottom:0;width: 100%;height: 100%;z-index: 12;text-align: right;"><img class="share-box-img" style="float: right;width: 80%;" src="'+feBaseUri+'wap/campaigns/active20170711/img/weixinShare.png" alt=""></div>';$("body").prepend(e),$(".mark-box").show(),$(".share-box").show()}function share(){$.get("/promotion/sanfu/add-share",function(e){if(0===e.code){var i=Date.parse(new Date);location.href="/promotion/sanfu/?_mark="+i}})}var title="三伏邀请翻牌子抽千元大奖，快来抢！",desc="冰凉夏日，解暑必备！";$(function(){closeShare(),$(".share").on("click",function(){var e=(window.location.protocol,window.location.host.toLocaleLowerCase());if("app."===e.substr(0,4)){share();var i=linkUrl,o=imgUrl,n={title:title,des:des,linkurl:i,thumurl:o};browser.versions.ios||browser.versions.iPad||browser.versions.iPhone?window.webkit.messageHandlers.share.postMessage(n):browser.versions.android?window.shareAction.share(title,des,i,o):popShare()}else popShare()})});var browser={versions:function(){{var e=navigator.userAgent;navigator.appVersion}return{trident:e.indexOf("Trident")>-1,presto:e.indexOf("Presto")>-1,webKit:e.indexOf("AppleWebKit")>-1,gecko:e.indexOf("Gecko")>-1&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/)||!!e.match(/AppleWebKit/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:e.indexOf("Android")>-1||e.indexOf("Linux")>-1,iPhone:e.indexOf("iPhone")>-1||e.indexOf("Mac")>-1,iPad:e.indexOf("iPad")>-1,webApp:-1==e.indexOf("Safari"),weiXin:e.indexOf("MicroMessenger")>-1,weibo:e.indexOf("Weibo")>-1,qq:e.indexOf("QQ/")>-1&&(!!e.match(/AppleWebKit.*Mobile.*/)||!!e.match(/AppleWebKit/))}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};$.get("/weixin/auth",{appId:1,url:location.protocol+"//"+location.hostname+location.pathname+location.search},function(e){wx.config({appId:appId,timestamp:e.timestamp,nonceStr:e.nonceStr,signature:e.signature,jsApiList:["onMenuShareAppMessage","onMenuShareTimeline"]}),wx.ready(function(){wx.onMenuShareAppMessage({title:title,desc:desc,link:linkUrl,imgUrl:imgUrl}),wx.onMenuShareTimeline({title:title,link:linkUrl,imgUrl:imgUrl,success:function(){share()}})}),wx.error(function(e){console.log(e)})});