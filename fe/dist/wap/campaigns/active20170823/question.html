<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>七夕闯关作战</title>
	<link rel="stylesheet" href="__FE_BASE_URI__/common/css/wenjfbase.css?v=1.0">
	<link rel="stylesheet" href="__FE_BASE_URI__wap/campaigns/active20170823/css/question.css">
	<script src="__FE_BASE_URI__/libs/lib.flexible3.js"></script>
	<script src="__FE_BASE_URI__/libs/jquery-1.11.1.min.js"></script>
</head>
<body>
<div class="flex-content">
	<div class="part-top"></div>
	<div class="part-middle">
		<div class="page-ready">
			<p>纤云弄巧，飞星传恨，</p>
			<p>银汉迢迢暗度。</p>
			<p>又是一年七夕到，</p>
			<p>快来免费玩答题，</p>
			<p>还能100%领红包哦！</p>
			<div class="btn-begin"></div>
		</div>
		<div class="page-question" style="display: none;">
			<div class="question-title">
				<p>1、七夕源自哪一对情侣的故事？</p>
			</div>
			<ul class="question-options clearfix">
				<li><img src="__FE_BASE_URI__wap/campaigns/active20170823/images/dot_1.png" alt=""><span>牛郎织女</span></li>
				<li><img src="__FE_BASE_URI__wap/campaigns/active20170823/images/dot_1.png" alt=""><span>梁山伯祝英台</span></li>
				<li><img src="__FE_BASE_URI__wap/campaigns/active20170823/images/dot_1.png" alt=""><span>张生莺莺</span></li>
				<li><img src="__FE_BASE_URI__wap/campaigns/active20170823/images/dot_1.png" alt=""><span>焦仲卿刘兰芝</span></li>
			</ul>
			<p class="question-warning yincang">提示：答案错误</p>
			<div class="question-button"></div>
		</div>
		<div class="page-result" style="display: none">
			<p class="result-correct">您答对了 <span>5</span> 题</p>
			<p class="result-congra">恭喜您获得</p>
			<div class="result-coupon">
				<p class="coupon-jine"><span>10</span>元代金券</p>
				<p class="coupon-qitou"><span>10000</span>元起投</p>
			</div>
			<div class="result-link clearfix">
				<!--<a href="#" class="lf"></a>-->
				<!--此处是不可点击状态下的按钮-->
				<a href="#" class="lf link-disable"></a>
				<a href="#" class="rg"></a>
			</div>
		</div>
	</div>
	<div class="part-bottom"></div>
</div>
<script>
  //题库
  var quesLib = [
    {'title': '、七夕源自哪一对情侣的故事？', 'options': ['牛郎织女', '焦仲卿刘兰芝', '张生莺莺', '梁山伯祝英台'], 'answer': '1'},
    {'title': '、七夕七巧源于哪个朝代？', 'options': ['汉朝', '唐朝', '宋朝', '明朝'], 'answer': '1'},
    {'title': '、阻挡牛郎织女的银河是什么？', 'options': ['金箍棒', '宝莲灯', '玉净瓶', '王母的簪子'], 'answer': '4'},
    {'title': '、以下不属于七夕别称的是', 'options': ['乞巧节', '女儿节', '午日节', '穿针节'], 'answer': '3'},
    {'title': '、七夕又称乞巧节，乞巧指的是什么？', 'options': ['心灵手巧', '来年丰收', '生活富足', '子孙满堂'], 'answer': '1'},
    {'title': '、每年七夕，牛郎织女会在哪里相见？', 'options': ['网络', '月亮', '梦里', '鹊桥'], 'answer': '4'},
    {'title': '、七夕的应节小吃是什么？', 'options': ['月饼', '粽子', '饺子', '巧果'], 'answer': '4'},
    {'title': '、以下哪个不是七夕的习俗？', 'options': ['穿针乞巧', '赛龙舟', '喜蛛应巧', '投针验巧'], 'answer': '2'},
  ];
  //生成随机1-8的数组
  function createRandom(num, from, to) {
    var arr = [];
    var json = {};
    while (arr.length < num) {
      //产生单个随机数
      var ranNum = Math.ceil(Math.random() * (to - from)) + from;
      //通过判断json对象的索引值是否存在 来标记 是否重复
      if (!json[ranNum]) {
        json[ranNum] = 1;
        arr.push(ranNum);
      }
    }
    return arr;
  }
  $(function () {
    var quesArr = createRandom(5, 0, 7);
    var quesLibNow = [];
    //当前问题序号
    var quesIndex = 1;
    //当前问题的答案序号
    var answerSelect;
    for (var i = 0; i < 5; i++) {
      quesLibNow[i] = quesLib[quesArr[i]];
    }
    //渲染当前题目和答案
    $(".page-question .question-title p").text(quesIndex + quesLibNow[0].title);
    for (var j = 0; j < 4; j++) {
      $(".page-question .question-options li:eq(" + j + ") span").text(quesLibNow[0].options[j])
    }
    var answerNow = quesLibNow[0].answer;

    //点击准备页按钮开始答题
    $(".page-ready .btn-begin").click(function () {
      $(".page-ready").hide();
      $(".page-question").show();
    });

    //点击选项
    $(".question-options li").click(function () {
      $(this).find('img').attr('src', 'images/dot_2.png').parent().siblings().find('img').attr('src', 'images/dot_1.png');
      answerSelect = $(this).index() + 1;
    });

    //点击提交按钮
    $(".page-question .question-button").click(function () {
      if (answerSelect == answerNow) {
        if (quesIndex < 5) {
          $(".question-warning").addClass('yincang');
          quesIndex++;
          $(".page-question .question-title p").text(quesIndex + quesLibNow[quesIndex - 1].title);
          for (var j = 0; j < 4; j++) {
            $(".page-question .question-options li:eq(" + j + ") span").text(quesLibNow[quesIndex - 1].options[j]);
            $(".page-question .question-options li:eq(" + j + ") img").attr('src', 'images/dot_1.png');
          }
          answerNow = quesLibNow[quesIndex - 1].answer;
        } else {
          $(".page-question").hide();
          $(".page-result").show();
        }
      } else {
        $(".question-warning").removeClass('yincang');
        return false;
      }
    });
  })
</script>
</body>
</html>